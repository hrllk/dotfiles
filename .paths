export MAVEN_HOME=/opt/homebrew/Cellar/maven/3.9.9/libexec
export GRADLE_HOME=$HOME/task/tmp/gradle-8.10.2
# export JAVA_HOME=/opt/homebrew/opt/openjdk@21
export JAVA_HOME=/opt/homebrew/opt/openjdk@17
# export JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home
export IMAGEMAGICK_HOME=/opt/homebrew/var/homebrew/linked/imagemagick
export DYLD_FALLBACK_LIBRARY_PATH=/opt/homebrew/var/homebrew/linked/imagemagick/lib


export PATH=/opt/homebrew/bin:$PATH
export PATH=$HOME/.rbenv/versions/3.1.4/bin:$PATH
export PATH=$JAVA_HOME/bin:$PATH
export PATH=/opt/homebrew/bin:$PATH
export PATH=/Applications/IntelliJ\ IDEA.app/Contents/MacOS:$PATH
export PATH=$IMAGEMAGICK_HOME/bin:$PATH
export PATH=/opt/homebrew/opt/kafka/bin:$PATH
export PATH=$HOME/.rd/bin:$PATH
export PATH=/usr/local/texlive/2025/bin/universal-darwin:$PATH
export PATH="$HOME/.local/bin:$PATH"

export PATH="/usr/local/bin:$PATH"


export NVM_DIR="$HOME/.nvm"

export PATH=$HOME/.local/bin:$PATH

export EDITOR="nvim"

__load_nvm() {
  if typeset -f nvm >/dev/null 2>&1; then
    export __NVM_LOADED=1
    return 0
  fi

  local nvm_script=""
  if [ -s "$NVM_DIR/nvm.sh" ]; then
    nvm_script="$NVM_DIR/nvm.sh"
  elif [ -s "/opt/homebrew/opt/nvm/nvm.sh" ]; then
    nvm_script="/opt/homebrew/opt/nvm/nvm.sh"
  fi

  if [ -z "$nvm_script" ]; then
    return 1
  fi

  . "$nvm_script"
  if ! typeset -f nvm >/dev/null 2>&1; then
    return 1
  fi
  # Ensure a concrete Node version is active so global bins are in PATH.
  nvm use --silent default >/dev/null 2>&1 || nvm use --silent node >/dev/null 2>&1 || true
  export __NVM_LOADED=1
}

__run_with_nvm() {
  local cmd="$1"
  shift
  __load_nvm >/dev/null 2>&1 || true
  if ! command -v "$cmd" >/dev/null 2>&1; then
    nvm use --silent default >/dev/null 2>&1 || nvm use --silent node >/dev/null 2>&1 || true
  fi
  command "$cmd" "$@"
}

nvm() {
  unset -f nvm
  if ! __load_nvm; then
    echo "nvm loader not found: $NVM_DIR/nvm.sh or /opt/homebrew/opt/nvm/nvm.sh" >&2
    return 127
  fi
  if ! typeset -f nvm >/dev/null 2>&1; then
    echo "nvm function failed to load from: $NVM_DIR/nvm.sh or /opt/homebrew/opt/nvm/nvm.sh" >&2
    return 127
  fi
  nvm "$@"
}

node() { unset -f node; __run_with_nvm node "$@"; }
npm() { unset -f npm; __run_with_nvm npm "$@"; }
npx() { unset -f npx; __run_with_nvm npx "$@"; }
codex() { unset -f codex; __run_with_nvm codex "$@"; }
gemini() { unset -f gemini; __run_with_nvm gemini "$@"; }
task-master() { unset -f task-master; __run_with_nvm task-master "$@"; }
openclaw() { unset -f openclaw; __run_with_nvm openclaw "$@"; }
